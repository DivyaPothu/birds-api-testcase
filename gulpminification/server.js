var pg=require("pg"),Sequelize=require("sequelize"),app=require("express")(),http=require("http").Server(app),env="development"==app.get("env")?"dev":app.get("env");pg.defaults.ssl=void 0!=process.env.DATABASE_URL;var port=process.env.PORT||8086,bodyParser=require("body-parser");app.use(bodyParser.urlencoded({extended:!1})),app.use(bodyParser.json());var router=(express=require("express")).Router(),sequelize=new Sequelize("ddoekvsmvbt4bm","fnykiielutjcbx","25236de90eda0295f5f26480a2a5686ce817d6bc8f7b3e88ac0c9809367a42cd",{host:"ec2-54-235-90-107.compute-1.amazonaws.com",port:5432,dialect:"postgres",dialectOptions:{ssl:!0},DATABASE_URL:"postgres://fnykiielutjcbx:25236de90eda0295f5f26480a2a5686ce817d6bc8f7b3e88ac0c9809367a42cd@ec2-54-235-90-107.compute-1.amazonaws.com:5432/ddoekvsmvbt4bm"});sequelize.authenticate().then(()=>{console.log("Connection has been established successfully.")}).catch(e=>{console.error("Unable to connect to the database:",e)});var Birds=sequelize.define("bird_tables",{id:{type:Sequelize.STRING,primaryKey:!0},name:{type:Sequelize.STRING},family:{type:Sequelize.STRING},continents:{type:Sequelize.STRING},added:{type:Sequelize.STRING},visible:{type:Sequelize.STRING,defaultValue:!1},createdAt:{type:Sequelize.DATE},updatedAt:{type:Sequelize.DATE}});sequelize.sync({force:!0}).then(function(e){console.log("It worked!table created successfully")},function(e){console.log("An error occurred while creating the table:",e)}),sequelize.sync({force:!0}).then(function(){Birds.create({id:"1",name:"Dove",family:"DoveFamily",continents:"india",added:"2017-10-04",visible:"true"}).then(function(){console.log("Data successfully inserted")})});var express=require("express"),bodyParser=require("body-parser");app.get("/",function(e,t){t.send("hello")}),app.get("/Get",function(e,t){var a={Data:""};sequelize.query("SELECT * FROM bird_tables where visible=:visible",{replacements:{visible:"true"},type:sequelize.QueryTypes.SELECT}).then(function(e,s,r,i){e&&(a.Data=e,t.json(a))})}),app.post("/Postbird",function(e,t){var a=e.body.id,s=e.body.name,r=e.body.family,i=e.body.continents,o=e.body.added,d=e.body.visible;console.log(e.body),console.log(a);var n={Data:""};a&&s&&r&&i&&o&&d?sequelize.query("INSERT INTO bird_tables (id,name,family,continents,added,visible) VALUES('"+a+"','"+s+"','"+r+"','"+i+"','"+o+"','"+d+"')",[a,s,r,i,o,d],{type:sequelize.QueryTypes.INSERT}).then(function(e,a){n.Data=a?"Error Adding data":"Bird Added Successfully",t.json(n)}):(n.Data="Please provide all required data of bird",t.status(400).json(n))}),app.put("/Putbird",function(e,t){var a=e.body.id,s=e.body.name,r={Data:""};a&&s?sequelize.query("UPDATE bird_tables set name= '"+s+"' where id= '"+a+"' ",[a,s],{type:sequelize.QueryTypes.UPDATE}).then(function(e,a){r.Data=a?"Error Adding data":"Bird Updated Successfully",t.json(r)}):(r.Data="Please provide all required data of bird",t.status(404).json(r))}),app.delete("/Deletebird",function(e,t){var a=e.body.id,s={Data:""};a?sequelize.query("DELETE from  bird_tables where id= '"+a+"' ",[a],{type:sequelize.QueryTypes.DELETE}).then(function(e,a){s.Data=a?"Error Adding data":"Bird Deleted Successfully",t.json(s)}):(s.Data="Please provide all required data of bird",t.status(404).json(s))}),app.listen(port),console.log("Magic happens on port "+port);